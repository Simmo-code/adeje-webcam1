
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Adeje & Taucho Ops – Webcams Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
<style>
  :root {
    --panel-bg: rgba(255,255,255,0.98);
    --border: #e5e7eb;
    --shadow: 0 10px 30px rgba(0,0,0,0.18);
  }
  html, body { height: 100%; margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
  #map { height: 100%; width: 100%; }
  /* Mobile-first overlay panel */
  .fab {
    position: fixed; right: 14px; bottom: 14px; z-index: 1100;
    width: 54px; height: 54px; border-radius: 50%; border: none;
    box-shadow: var(--shadow); background: #111827; color: #fff; font-size: 24px;
  }
  .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.35); backdrop-filter: blur(1px); z-index: 1000; display: none; }
  .sheet {
    position: fixed; left: 0; right: 0; bottom: 0; z-index: 1001;
    background: var(--panel-bg); border-top-left-radius: 16px; border-top-right-radius: 16px;
    box-shadow: var(--shadow);
    transform: translateY(100%); transition: transform 0.3s ease;
    max-height: 80vh; display: flex; flex-direction: column;
  }
  .sheet.open { transform: translateY(0); }
  .overlay.open { display: block; }
  .grip { width: 48px; height: 5px; background:#d1d5db; border-radius: 999px; margin: 8px auto; }
  .sheet-content { padding: 10px 14px 14px; overflow: auto; }
  .h {
    margin: 0 0 6px 0; font-size: 16px; display:flex; align-items:center; justify-content: space-between;
  }
  .row { display:flex; gap:8px; align-items:center; margin-bottom:8px; }
  .input { flex:1; min-width:140px; padding:8px 10px; border-radius:8px; border:1px solid var(--border); }
  .chip { border:1px solid var(--border); border-radius:999px; padding:6px 10px; font-size:12px; cursor:pointer; user-select:none; }
  .list { list-style:none; padding:0; margin:0; }
  .item { padding:8px 0; border-bottom:1px solid var(--border); }
  .item a { text-decoration:none; font-weight:600; color:#0366d6; }
  /* Desktop: show panel on the left like before */
  @media (min-width: 900px) {
    .fab, .overlay { display: none !important; }
    .sheet { position:absolute; top:10px; left:10px; right:auto; bottom:auto; max-height:70vh; width:360px; transform:none; }
    .grip { display:none; }
  }
  /* Accordion */
  details { border:1px solid var(--border); border-radius:10px; padding:8px 10px; margin:10px 0; background: #fff; }
  summary { cursor:pointer; font-weight:700; }
  summary::marker { content: ''; }
  summary::after { content: '▾'; float:right; }
  details[open] summary::after { content: '▴'; }
  .muted { color:#6b7280; font-size:12px; }
</style>
</head>
<body>
<div id="map"></div>

<button class="fab" id="fab" aria-label="Open menu" aria-expanded="false">☰</button>
<div class="overlay" id="overlay" aria-hidden="true"></div>

<div class="sheet" id="sheet" role="dialog" aria-modal="true" aria-labelledby="title">
  <div class="grip" id="grip"></div>
  <div class="sheet-content">
    <h2 class="h" id="title">Webcams <button id="closeBtn" class="chip" aria-label="Close">Close ✕</button></h2>
    <div class="row">
      <input id="q" class="input" placeholder="Search webcams..." />
      <label class="chip"><input id="opsToggle" type="checkbox" checked style="margin-right:6px">Taucho ops only</label>
    </div>

    <details open>
      <summary>List</summary>
      <ul id="list" class="list"></ul>
    </details>

    <details>
      <summary>Paragliding & weather</summary>
      <ul class="list">
        <li class='item'><a href='https://www.windfinder.com/forecast/taucho' target='_blank' rel='noopener'>Windfinder – Taucho forecast</a></li><li class='item'><a href='https://en.windfinder.com/webcams/taucho' target='_blank' rel='noopener'>Windfinder – Taucho webcams map</a></li><li class='item'><a href='https://www.paraglidingmap.com/launches/taucho' target='_blank' rel='noopener'>Paragliding Map – Taucho launch</a></li><li class='item'><a href='https://www.webtenerife.co.uk/what-to-do/sports/air/paragliding/taucho-adeje/' target='_blank' rel='noopener'>Tenerife Tourism – Taucho site info</a></li><li class='item'><a href='https://www.webtenerife.co.uk/what-to-do/sports/air/paragliding/ifonche-vilaflor/' target='_blank' rel='noopener'>Ifonche site info (Tenerife Tourism)</a></li>
      </ul>
      <div class="muted">Ajabo, La Enramada, Las Galgas, Golf Adeje are great coastal indicators for Taucho.</div>
    </details>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script>
  const WEBCAMS = [{"name": "Playa del Duque (Skyline)", "lat": 28.0914, "lon": -16.7439, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-del-duque.html", "area": "Adeje", "ops": ""}, {"name": "Playa del Duque \u2013 El Beril (Skyline)", "lat": 28.0935, "lon": -16.7505, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-del-duque-el-beril.html", "area": "Adeje", "ops": ""}, {"name": "Playa de Fa\u00f1ab\u00e9 (Skyline)", "lat": 28.08495, "lon": -16.73697, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-de-fanabe.html", "area": "Adeje", "ops": "Taucho ops"}, {"name": "Playa de Torviscas (Index)", "lat": 28.08231, "lon": -16.73616, "url": "https://worldcam.eu/webcams/africa/canary-islands/32119-tenerife-costa-adeje-playa-de-torviscas", "area": "Adeje", "ops": ""}, {"name": "Playa La Pinta (Skyline)", "lat": 28.0798185, "lon": -16.7353506, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-la-pinta.html", "area": "Adeje", "ops": ""}, {"name": "Playa del Bobo (Skyline)", "lat": 28.0796, "lon": -16.7336, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-del-bobo.html", "area": "Adeje", "ops": ""}, {"name": "El Duque Norte (Costa Adeje)", "lat": 28.095, "lon": -16.7467, "url": "https://costa-adeje.es/en/webcams/el-duque-norte", "area": "Adeje", "ops": ""}, {"name": "La Caleta - Playa La Enramada (Skyline)", "lat": 28.0983472222, "lon": -16.7521944444, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/la-caleta-costa-adeje.html", "area": "La Caleta", "ops": "Taucho ops"}, {"name": "Golf Costa Adeje (Skyline)", "lat": 28.1032, "lon": -16.7496, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/golf-costa-adeje.html", "area": "La Caleta", "ops": "Taucho ops"}, {"name": "Playa Para\u00edso \u2013 Las Galgas (WhatsUpCams)", "lat": 28.1185, "lon": -16.7779, "url": "https://www.whatsupcams.com/en/webcams/spain/canary-islands/tenerife/live-webcam-playa-de-las-galgas-playa-paraiso-la-gomera-island-adeje-tenerife/", "area": "Playa Para\u00edso", "ops": "Taucho ops"}, {"name": "Callao Salvaje \u2013 Playa de Ajabo (Skyline)", "lat": 28.1229, "lon": -16.7934, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/callao-salvaje.html", "area": "Callao Salvaje", "ops": "Taucho ops"}, {"name": "Playa de Las Vistas \u2013 Los Cristianos (Skyline)", "lat": 28.0526061111, "lon": -16.7247833333, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-las-vistas.html", "area": "Los Cristianos", "ops": ""}, {"name": "Playa de Los Cristianos (Skyline)", "lat": 28.0557, "lon": -16.7205, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-los-cristianos.html", "area": "Los Cristianos", "ops": ""}, {"name": "Bah\u00eda de Los Cristianos \u2013 Costamar (Skyline)", "lat": 28.049, "lon": -16.7169, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/bahia-los-cristianos.html", "area": "Los Cristianos", "ops": ""}, {"name": "Playa de Troya (Skyline)", "lat": 28.058056, "lon": -16.735556, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-troya.html", "area": "Las Am\u00e9ricas", "ops": ""}, {"name": "Puerto de Santiago \u2013 Playa La Arena (Skyline)", "lat": 28.222, "lon": -16.844, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/santiago-del-teide-puerto-de-santiago.html", "area": "Puerto de Santiago", "ops": ""}, {"name": "Los Gigantes Cliffs & Marina (Skyline)", "lat": 28.243, "lon": -16.853, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/los-gigantes.html", "area": "Los Gigantes", "ops": ""}, {"name": "El M\u00e9dano Beach (Skyline)", "lat": 28.0458, "lon": -16.536, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/playa-de-el-medano.html", "area": "El M\u00e9dano", "ops": ""}, {"name": "El M\u00e9dano \u2013 Surf & Kitesurf (Skyline)", "lat": 28.0469, "lon": -16.533, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/surf-kitesurf-medano.html", "area": "El M\u00e9dano", "ops": ""}, {"name": "Karting Club Tenerife \u2013 Las Chafiras (Skyline)", "lat": 28.0629, "lon": -16.6078, "url": "https://www.skylinewebcams.com/en/webcam/espana/canarias/santa-cruz-de-tenerife/karting-club-tenerife.html", "area": "Las Chafiras", "ops": "Taucho ops"}, {"name": "HOVIMA Costa Adeje \u2013 Pool/Sea (WebcamTaxi)", "lat": 28.0815, "lon": -16.7324, "url": "https://www.webcamtaxi.com/en/spain/tenerife/pool-hovima-costa-adeje.html", "area": "Adeje", "ops": ""}];

  // Map
  const map = L.map('map');
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  const markers = L.markerClusterGroup();
  const markerIndex = new Map();

  function addMarkers(opsOnly) {
    markers.clearLayers();
    WEBCAMS.forEach(w => {
      if (opsOnly && !w.ops) return;
      const m = L.marker([w.lat, w.lon]).bindPopup(`<strong>${w.name}</strong><br><span class='muted'>${w.area}{w.ops ? " • Taucho ops" : ""}</span><br><a href='${w.url}' target='_blank' rel='noopener'>Open live webcam</a>`);
      markers.addLayer(m);
      markerIndex.set(w.name, m);
    });
    if (!map.hasLayer(markers)) map.addLayer(markers);
  }

  function fitAll(opsOnly) {
    const pts = WEBCAMS.filter(w => !opsOnly || w.ops).map(w => [w.lat, w.lon]);
    if (pts.length) map.fitBounds(L.latLngBounds(pts), {padding:[20,20]});
  }

  addMarkers(true);
  fitAll(true);

  // UI logic
  const fab = document.getElementById('fab');
  const sheet = document.getElementById('sheet');
  const overlay = document.getElementById('overlay');
  const closeBtn = document.getElementById('closeBtn');
  function openSheet() { sheet.classList.add('open'); overlay.classList.add('open'); overlay.setAttribute('aria-hidden','false'); fab.setAttribute('aria-expanded','true'); }
  function closeSheet() { sheet.classList.remove('open'); overlay.classList.remove('open'); overlay.setAttribute('aria-hidden','true'); fab.setAttribute('aria-expanded','false'); }
  fab.addEventListener('click', openSheet);
  closeBtn.addEventListener('click', closeSheet);
  overlay.addEventListener('click', closeSheet);

  // Drag-to-close hint (grip)
  let startY = null;
  document.getElementById('grip').addEventListener('touchstart', e => { startY = e.touches[0].clientY; });
  document.getElementById('grip').addEventListener('touchmove', e => {
    if (startY === null) return;
    const dy = e.touches[0].clientY - startY;
    if (dy > 80) closeSheet();
  });
  document.getElementById('grip').addEventListener('touchend', () => startY = null);

  // List/search/filters
  const listEl = document.getElementById('list');
  const qEl = document.getElementById('q');
  const opsToggle = document.getElementById('opsToggle');

  function renderList(filter='') {
    const q = filter.toLowerCase();
    const opsOnly = opsToggle.checked;
    listEl.innerHTML = WEBCAMS
      .filter(w => !opsOnly || w.ops)
      .filter(w => !q || w.name.toLowerCase().includes(q) || w.area.toLowerCase().includes(q))
      .map(w => `<li class="item"><a href="#" onclick="flyTo(${w.lat},${w.lon});return false;">${w.name}</a> <span class='muted'>(${w.area}${w.ops ? " • Taucho ops" : ""})</span></li>`)
      .join('');
  }
  renderList();

  qEl.addEventListener('input', () => renderList(qEl.value));
  opsToggle.addEventListener('change', () => { addMarkers(opsToggle.checked); fitAll(opsToggle.checked); renderList(qEl.value); });

  window.flyTo = (lat, lon) => {
    closeSheet();
    map.flyTo([lat, lon], 16, {duration:0.8});
    setTimeout(() => {
      markers.eachLayer(layer => {
        const ll = layer.getLatLng();
        if (Math.abs(ll.lat-lat)<1e-6 && Math.abs(ll.lng-lon)<1e-6) layer.openPopup();
      });
    }, 900);
  }
</script>
</body>
</html>
